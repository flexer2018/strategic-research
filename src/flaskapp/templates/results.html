{% extends "layout.html" %}
{% from "macros.html" import project_record with context %}
{% from "macros.html" import project_record_modal with context %}
{% from "macros.html" import publication_record with context %}
{% from "macros.html" import publication_record_modal with context %}
{% block content %}

<main onload="setButtonState();" class="explore-grid-container" style="zoom: 90%">

  <body onload="setButtonState({{buttonStates}});">
    <div class="unique-color-dark" style="grid-column: 1/end; grid-row: 1/3"></div>
    <h1 id="heading" class="white-text mb-3">
      {{ heading }}
    </h1>

    <div id="sidenav-results" class="content-section">

      <h4>Filter Options</h4>

      <p class='text-muted'>
        Select from the following options to filter the results in the matrix.
      </p>
      <form name="filter_form" action="{{ url_for('results') }}" method="post"
        class="text-left white border border-light p-3">
        <input type="hidden" value="{{ formdata['type'] }}" name="type">
        <input type="hidden" value="{{ formdata['query'] }}" name="query">
        <label for="topic">Topic Tags</label>
        <select name="topic" class="browser-default custom-select form-select">
          <option value="" disabled>Choose Option</option>
          <option value="all">All Research Topics</option>
          <option value="construction_quality">Construction Quality</option>
          <option value="design_and_details">Design & Details</option>
          <option value="material_specifications">Material Specifications</option>
          <option value="live_load">Live Load</option>
          <option value="environment">Environment</option>
          <option value="maintenance_and_preservation">Maintenance & Preservation</option>
          <option value="structural_integrity">Structural Integrity</option>
          <option value="structural_condition">Structural Condition</option>
          <option value="functionality">Functionality</option>
          <option value="cost">Cost</option>
        </select>
        <hr>
        <label for="element">Element Tags</label>
        <select name="element" class="browser-default custom-select form-select">
          <option value="" disabled>Choose Option</option>
          <option value="all">All Bridges & Structures</option>
          <option value="superstructure">All Superstructure</option>
          <option value="untreated_deck">Untreated Bridge Decks</option>
          <option value="treated_deck">Treated Bridge Decks</option>
          <option value="joints">Joints</option>
          <option value="bearings">Bearings</option>
          <option value="coatings">Steel Coatings</option>
          <option value="prestressing">Prestressing</option>
        </select>
        <hr>
        <label>Record Type</label>
        <div class="custom-control custom-radio">
          <input value="projects" type="radio" onclick="enableStatus(); setSortOption('project')"
            class="custom-control-input" id="rt2" name="index" checked>
          <label class="custom-control-label" for="rt2">Projects</label>
        </div>
        <div class="custom-control custom-radio">
          <input value="publications" type="radio" onclick="disableStatus(); setSortOption('publication')"
            class="custom-control-input" id="rt3" name="index">
          <label class="custom-control-label" for="rt3">Publications</label>
        </div>
        <hr>
        <label for="status">Status</label>
        <select id="status" name="status" class="browser-default custom-select form-select">
          <option value="" disabled>Choose Option</option>
          <option value="all" selected>All</option>
          <option value="active">Active</option>
          <option value="completed">Complete</option>
          <option value="programmed">Programmed</option>
          <option value="proposed">Proposed</option>
        </select>
        <hr>
        <label>Date Range</label>
        <div class="custom-control custom-radio">
          <input value=1 type="radio" class="custom-control-input" id="dr1" name="dateRange" checked>
          <label class="custom-control-label" for="dr1">1 Year</label>
        </div>
        <div class="custom-control custom-radio">
          <input value=5 type="radio" class="custom-control-input" id="dr2" name="dateRange">
          <label class="custom-control-label" for="dr2">5 Years</label>
        </div>
        <div class="custom-control custom-radio">
          <input value=50 type="radio" class="custom-control-input" id="dr3" name="dateRange">
          <label class="custom-control-label" for="dr3">10+ Years</label>
        </div>
        <hr>
        <label for="sortBy">Sort By</label>
        <select name="sortBy" class="browser-default custom-select">
          <option value="" disabled>Choose Option</option>
          <option value="score">Relevance</option>
          <option value="date" selected>Start Date</option>
          <!-- <option value="both">Relevance & Date</option> -->
        </select>
        <hr>
        <button class="btn btn-info btn-block btn-blue-grey mt-3" type="submit" name="form" value="filters">
          Apply
        </button>
      </form>
    </div>

    <div id="results-summary">
      <h5>Showing {{ content.hits.total }} results {{ clicked }}.</h5>
    </div>

    <div id="results">
      {% for doc in content %}
      {% if doc.doc_type == 'project' %}
      {{ project_record(doc) }}
      {% else %}
      {{ publication_record(doc) }}
      {% endif %}
      {% endfor %}
    </div>

    <div id="modals">

      {% for doc in content %}
      {% if doc.doc_type == 'project' %}
      {{ project_record_modal(doc, formdata) }}
      {% else %}
      {{ publication_record_modal(doc, formdata) }}
      {% endif %}
      {% endfor %}
      <!-- modal template -->
      <div class="modal fade" id="modal_template" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
        aria-hidden="true">
        <div class="modal-dialog modal-fluid modal-notify modal-custom" role="document">
          <div class="modal-content">
            <div class="modal-header">
              <!-- title -->
              <h3 id="mt_title" class="modal-title w-100 pl-4 pr-4">
                None
              </h3>
              <!-- close button -->
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
              </button>
            </div>
            <div class="modal-body pl-5 pr-5 pb-5">
              <!-- record type -->
              <h4 class="d-inline mb-0">
                <span id="mt_record_type" class="badge primary-color-dark text-capitalize z-depth-0">
                  None
                </span>
              </h4>
              <!-- record tag -->
              <h4 id="mt_tags" class="d-inline">
                <span class="badge teal darken-1 z-depth-0 ml-1">
                  None
                </span>
              </h4>
              <!-- element tags -->
              <h4 id="mt_elem_tags" class="d-inline">
                <span class="badge orange darken-3 z-depth-0 ml-1">
                  None
                </span>
              </h4>

              <hr>
              <div class="modal-grid-container">
                <div class="modal-record-content">
                  <!-- bookmark button -->
                  <button id="mt_modal_bookmark_btn" type="button" value=""
                    class="btn btn mt-2 float-right waves-effect red darken-4 p-1 pl-2 pr-2 unmarked">
                    <i id="mt_modal_bookmark_icon" class="fa fa-bookmark-o fa-lg pr-1" aria-hidden="true"></i>
                    <div id="mt_modal_bookmark_text" class="d-inline">
                      Bookmark
                    </div>
                  </button>
                  <!-- abstract -->
                  <h4 class="mb-2 mt-2">
                    Abstract/Objectives:
                  </h4>
                  <p id="mt_abstract" class="m-0">
                    None
                  </p>
                  <!-- project status -->
                  <h4 class="mb-2 mt-2">
                    Status:
                  </h4>
                  <p id="mt_status" class="m-0">
                    None
                  </p>
                  <!-- funding -->
                  <h4 class="mb-2 mt-2">
                    Fund Amount:
                  </h4>
                  <p id="mt_funding" class="m-0">
                    None
                  </p>
                  <!-- funding organization -->
                  <h4 class="mb-2 mt-2">
                    Funding Organizations:
                  </h4>
                  <div id="mt_fundagencies">
                    <p class="m-0">
                      None
                    </p>
                  </div>
                  <!-- performing agencies -->
                  <h4 class="mb-2 mt-2">
                    Performing Agencies:
                  </h4>
                  <p id="mt_perfagencies" class="m-0">
                    None
                  </p>
                  <!-- start date -->
                  <h4 class="mb-2 mt-2">
                    Start Date:
                  </h4>
                  <p id="mt_startdate" class="m-0">
                    None
                  </p>
                  <!-- expected/actual completion -->
                  <h4 class="mb-2 mt-2">
                    Expexcted/Actual Completion Date:
                  </h4>
                  <p id="mt_compdate" class="m-0">
                    None
                  </p>
                  <!-- urls -->
                  <h4 class="mb-2 mt-2">
                    URLs:
                  </h4>
                  <p id="mt_urls" class="ellipses w-50 m-0">
                    None
                  </p>
                  <!-- more like this -->
                  <div>
                    <h4 class="mb-3 mt-4 ml-0">
                      <a id="mt_mlt_btn" class="btn btn-light m-0" data-toggle="collapse" href="#mt_mlt_content"
                        role="button" aria-expanded="false" aria-controls="mt_mlt_content" value="">
                        More Like This
                      </a>
                    </h4>
                  </div>
                  <div class="row">
                    <div class="col">
                      <div class="collapse multi-collapse" id="mt_mlt_content">

                      </div>
                    </div>
                  </div>
                </div>
                <!-- modal options -->
                <div class="modal-record-options">
                  <div id="sidenav" class="content-section">
                    <form onsubmit="return false" id="mt_form" name="record_form"
                      class="text-left white border border-light p-3">
                      <h3 class="mb-2 mt-2">LTBP Objectives</h3>
                      <p class='text-muted'>
                        Mark documents that satisfy LTBP objectives.
                      </p>
                      <!-- Objective 1 -->
                      <div class="custom-control custom-checkbox">
                        <input type="checkbox" class="custom-control-input" id="mt_objective1" name="objective1">
                        <label class="custom-control-label" for="mt_objective1">
                          <h5>Objective 1</h5>
                        </label>
                      </div>
                      <p class='text-muted'>
                        Advance research in deterioration and predictive modeling.
                      </p>
                      <!-- Objective 2 -->
                      <div class="custom-control custom-checkbox">
                        <input type="checkbox" class="custom-control-input" id="mt_objective2" name="objective2">
                        <label class="custom-control-label" for="mt_objective2">
                          <h5>Objective 2</h5>
                        </label>
                      </div>
                      <p class='text-muted'>
                        Advance research in cost analysis.
                      </p>
                      <!-- Objective 3 -->
                      <div class="custom-control custom-checkbox">
                        <input type="checkbox" class="custom-control-input" id="mt_objective3" name="objective3">
                        <label class="custom-control-label" for="mt_objective3">
                          <h5>Objective 3</h5>
                        </label>
                      </div>
                      <p class='text-muted'>
                        Support the development and identification of improved design methods.
                      </p>
                      <!-- Objective 4 -->
                      <div class="custom-control custom-checkbox">
                        <input type="checkbox" class="custom-control-input" id="mt_objective4" name="objective4">
                        <label class="custom-control-label" for="mt_objective4">
                          <h5>Objective 4</h5>
                        </label>
                      </div>
                      <p class='text-muted'>
                        Quantify the effectiveness and support the development of improved
                        assessment, maintenance, preservation, repair, and rehabilitation strategies.
                      </p>
                      <div class="form-group green-border-focus">
                        <textarea class="form-control text-muted text-left" id="mt_notes" name="notes" rows="4" placeholder="Notes..."></textarea>
                      </div>
                      <input type="hidden" value="" name="doc_id">
                      <input type="hidden" value="" name="index">
                      <input type="hidden" value="" name="type">
                      <input type="hidden" value="" name="query">
                      <input type="hidden" value="" name="topic">
                      <input type="hidden" value="" name="element">
                      <input type="hidden" value="" name="status">
                      <input type="hidden" value="" name="dateRange">
                      <input type="hidden" value="" name="sortBy">
                      <button id="mt_submit" class="btn btn-info btn-block btn-light mt-3" type="submit" name="form" value="record">
                        Apply
                      </button>
                    </form>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </body>


</main>

{% endblock content %}